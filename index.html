
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>질소 기반 분자 조립 시뮬레이션</title>
  <script src="https://unpkg.com/3dmol/build/3Dmol-min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; text-align: center; padding: 20px; }
    h1 { color: #2c3e50; }
    #viewer { width: 100%; height: 400px; border: 1px solid #ccc; margin-top: 20px; }
    button { margin: 5px; padding: 10px 16px; font-size: 16px; border-radius: 8px; border: none; background: #3498db; color: white; cursor: pointer; }
    button:hover { background: #2980b9; }
    .info { margin-top: 20px; max-width: 600px; margin-left: auto; margin-right: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
  </style>
</head>
<body>
  <h1>질소 기반 분자 조립 시뮬레이션</h1>
  <div>
    <button onclick="addAtom('H')">H 추가</button>
    <button onclick="addAtom('F')">F 추가</button>
    <button onclick="resetMolecule()">초기화</button>
  </div>
  <div id="viewer"></div>
  <div class="info" id="infoBox"></div>

  <script>
    const viewer = $3Dmol.createViewer("viewer", { backgroundColor: "white" });
    let atomState = { N: true, H: 0, F: 0 };

    const molecules = {
      N: `N 0.000 0.000 0.000`,
      NH: `N 0.000 0.000 0.000
           H 0.9428 0.0000 0.3333`,
      NH2: `N 0.000 0.000 0.000
            H 0.9428 0.0000 0.3333
            H -0.4714 0.8165 0.3333`,
      NH3: `N 0.000 0.000 0.000
            H 0.9428 0.0000 0.3333
            H -0.4714 0.8165 0.3333
            H -0.4714 -0.8165 0.3333`,
      NF: `N 0.000 0.000 0.000
           F 0.9428 0.0000 0.3333`,
      NF2: `N 0.000 0.000 0.000
            F 0.9428 0.0000 0.3333
            F -0.4714 0.8165 0.3333`,
      NF3: `N 0.000 0.000 0.000
            F 0.9428 0.0000 0.3333
            F -0.4714 0.8165 0.3333
            F -0.4714 -0.8165 0.3333`
    };

    function renderStructure() {
      viewer.clear();
      const key = atomState.F > 0 ? "NF" + atomState.F : "NH" + atomState.H;
      const mol = key === "NH0" && atomState.F === 0 ? "N" : key;
      viewer.addModel(molecules[mol], "xyz");
      viewer.setStyle({}, { stick: {}, sphere: { scale: 0.3 } });
      viewer.zoomTo();
      viewer.render();
      updateInfo(mol);
    }

    function addAtom(type) {
      if (type === "H" && atomState.H < 3 && atomState.F === 0) {
        atomState.H += 1;
      } else if (type === "F" && atomState.F < 3 && atomState.H === 0) {
        atomState.F += 1;
      }
      renderStructure();
    }

    function resetMolecule() {
      atomState.H = 0;
      atomState.F = 0;
      renderStructure();
    }

    function updateInfo(key) {
      const infoBox = document.getElementById("infoBox");
      const descriptions = {
        N: "<h2>N (질소)</h2><p>질소 원자 하나만 존재하는 상태입니다.</p>",
        NH: "<h2>NH</h2><p>질소에 수소 하나가 결합한 상태입니다.</p>",
        NH2: "<h2>NH₂</h2><p>수소 2개가 결합한 상태입니다.</p>",
        NH3: "<h2>NH₃</h2><p>암모니아 분자 완성! 결합각은 약 107°입니다.</p>",
        NF: "<h2>NF</h2><p>질소에 플루오린 하나가 결합한 상태입니다.</p>",
        NF2: "<h2>NF₂</h2><p>플루오린 2개가 결합한 상태입니다.</p>",
        NF3: "<h2>NF₃</h2><p>삼불화질소 분자 완성! 결합각은 약 102.5°입니다. 벤트의 규칙이 적용됩니다.</p>"
      };
      infoBox.innerHTML = descriptions[key] || "";
    }

    // 초기 상태 렌더링
    renderStructure();
  </script>
</body>
</html>
